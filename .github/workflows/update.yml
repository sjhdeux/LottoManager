name: ë§¤ì£¼ ë¡œë˜ ë°ì´í„° ì—…ë°ì´íŠ¸

on:
  schedule:
    - cron: '0 14 * * 6'   # ë§¤ì£¼ í† ìš”ì¼ ë°¤ 11ì‹œ (KST)
  workflow_dispatch:

permissions:
  contents: write  # âœ… Pushë¥¼ ìœ„í•´ í•„ìš”í•œ ê¶Œí•œ

jobs:
  update:
    runs-on: ubuntu-latest

    steps:
      - name: ì €ì¥ì†Œ í´ë¡ 
        uses: actions/checkout@v3

      - name: Python ì„¤ì¹˜
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: requests ì„¤ì¹˜
        run: pip install requests

      - name: ë¡œë˜ ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹¤í–‰
        run: python update_lotto.py

      - name: ë³€ê²½ì‚¬í•­ ì»¤ë°‹ ë° í‘¸ì‹œ
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"

          git add data/lotto_data.json
          if git diff --cached --quiet; then
            echo "âœ… ë³€ê²½ì‚¬í•­ ì—†ìŒ. ì»¤ë°‹/í‘¸ì‹œ ìƒëµ"
          else
            git commit -m "ğŸ”„ ë¡œë˜ ë°ì´í„° ìë™ ì—…ë°ì´íŠ¸"
            git push
          fi
      - name: ì¶”ì²œ ë²ˆí˜¸ ìƒì„±
        run: python generate_prediction.py

      - name: ë³€ê²½ì‚¬í•­ ì»¤ë°‹ ë° í‘¸ì‹œ
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add data/*.json
          if git diff --cached --quiet; then
            echo "âœ… ë³€ê²½ì‚¬í•­ ì—†ìŒ. ì»¤ë°‹/í‘¸ì‹œ ìƒëµ"
          else
            git commit -m "ğŸ”„ ë¡œë˜ ë°ì´í„° ë° ì¶”ì²œë²ˆí˜¸ ìë™ ì—…ë°ì´íŠ¸"
            git push
          fi

          
